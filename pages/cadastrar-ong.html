<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <link rel="shortcut icon" href="../favicon/fav.ico" type="image/x-icon">

    <title>Doa PE</title>
    <link rel="stylesheet" href="../styles/config.css">
    <link rel="stylesheet" href="../styles/cadastrar-ou-editar-ong.css">
    <!-- <script src="../scripts/cadastrar-ong.js" defer></script> -->
</head>
<body>
    <header>
        <!-- Voltar pra HOME LOGADO (USER) -->
        <a href="../index-deslogado.html">
            <button id="btn-voltar">
                <img src="../images/seta-voltar.png" alt="Botão Voltar">voltar
            </button>
        </a>
    </header>

    <main>
        <section class="flex-container">
            <div id="paragrafo">
                <h1>Cadastrar ONG</h1>
            </div>

            <!-- Formulário -->
            <form autocomplete="off">
                <!-- OBS: O Chrome não está aceitando o autocomplete="off" em alguns casos, então uma forma para resolver isso é criar dois inputs, colocar o mesmo id para os dois e colocar o display: none no primeiro. -->

                <!-- Input NOME -->
                <div class="inputs">
                    <label for="ipt-nome">Nome</label>
                    <input type="text" id="ipt-nome" style="display: none;">
                    <input type="text" id="ipt-nome" class="caixa-input campos" maxlength="255" placeholder="Digite o nome da sua ONG..." oninput="nameValidate()">

                    <span class="alerta" id="min-carac-nome">Mínimo de 3 caracteres</span>
                </div>
            
                <!-- Input ENDEREÇO -->
                <div class="inputs">
                    <label for="ipt-endereco">Endereço</label>
                    <input type="text" name="endereco" id="ipt-endereco" class="caixa-input campos" placeholder="Ex: Rua Padre Inglês, 356 - Boa Vista, Recife" oninput="enderecoValidate()">

                    <span class="alerta">Mínimo de 20 caracteres</span>
                </div>
                
                <!-- Input E-MAIL -->
                <div class="inputs">
                    <label for="ipt-email">E-mail</label>
                    <input type="text" id="ipt-email" class="caixa-input campos" maxlength="345" placeholder="Ex: email@gmail.com" oninput="emailValidate()">

                    <span class="alerta">E-mail inválido</span>
                </div>
                
                <!-- Input CONTATO -->
                <div class="inputs">
                    <label for="ipt-contato">Contato</label>
                    <input type="text" id="telefone" class="caixa-input campos" maxlength="15" placeholder="Número de contato da ONG..." oninput="numeroValidate()">

                    <span class="alerta">Número inválido</span>
                </div>

                <!-- Input CNPJ -->
                <div class="inputs">
                    <label for="ipt-cnpj">CNPJ</label>
                    <input type="text" id="cnpj" class="caixa-input campos" maxlength="18" placeholder="Ex: xx.xxx.xxx/xxxx-xx" oninput="cnpjValidate()">

                    <span class="alerta">CNPJ incompleto</span>
                </div>

                <!-- Input TIPO -->
                <div class="inputs">
                    <label for="ipt-tipos">Finalidade</label>
                    <select id="select-finalidade" class="caixa-input campos">
                        <optgroup label="Escolha">
                            <option value="FinalidadeONG">Finalidade da ONG</option>
                            <option value="cuidaMeioAmb">Cuida do meio ambiente</option>
                            <option value="cuidaAnimAban">Cuida de animais abandonados</option>
                            <option value="cuidaCrianAdol">Cuida de crianças e adolescentes</option>
                            <option value="refeicao">Faz refeição</option>
                            <option value="distribuiRoupa">Distribuição de roupas</option>
                        </optgroup>
                    </select>

                    <span id="span-FinalidadeONG">Selecione uma opção</span>
                </div>

                <!-- Caixa Formas de Pagamento -->
                <div class="inputs">
                    <p class="subtitulo">Formas de Pagamentos</p>
                    <div id="ipt-pagamento">
                        <!-- Pix -->
                        <div class="flex-container-pagamento">
                            <label for="ipt-pix" class="label-pagameto">Pix</label>
                            <input type="text" id="ipt-pix" class="campos"  maxlength="32" placeholder="Digite seu pix..." oninput="pixValidate()">

                            <span class="alerta">Pix inválido</span>
                        </div>

                        <!-- Linha Divisória -->
                        <div id="flex-container-linha">
                            <div class="linha-vertical"></div>
                            <div id="linha-divisoria"></div>
                            <div class="linha-vertical"></div>
                        </div>

                        <!-- Conta Bancária -->
                        <div class="flex-container-pagamento">
                            <label class="label-pagameto">Conta Bancária</label>
                            <div class="flex">
                                <div class="alinhando-pagamentos">
                                    <div class="ipt-span-vertical">
                                        <input type="text" class="ipt-cbancaria campos" maxlength="8" placeholder="Número da conta" oninput="numcontaValidate()">

                                        <span class="alerta">Número inválido</span>
                                    </div>

                                    <div class="ipt-span-vertical">
                                        <input type="text" class="ipt-cbancaria campos" placeholder="Agência da conta" maxlength="4" oninput="agenciaValidate()">

                                        <span class="alerta">Agência inválido</span>
                                    </div>
                                </div>
                                <div class="alinhando-pagamentos">
                                    <div class="ipt-span-vertical">
                                        <input type="text" class="ipt-cbancaria campos" placeholder="Instituição da conta" oninput="instituicaoValidate()">

                                        <span class="alerta">Instituição inválida</span>
                                    </div>

                                    
                                    <div class="ipt-span-vertical">
                                        <select id="select-conta" class="ipt-cbancaria">
                                            <option id="option-fisrt-conta" value="tipoConta">Tipo da conta</option>
                                            <option value="contaCorrente">Conta corrente</option>
                                            <option value="contaPoupanca">Conta poupança</option>
                                        </select>

                                        <span id="span-TipoConta">Selecione uma opção</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Input REGIÃO-->
                <div class="inputs">
                    <label for="select-regiao">Região</label>
                    <select id="select-regiao">
                        <option value="SelecioneRegiao">Selecione uma região</option>
                        <option value="">Zona da Mata</option>
                        <option value="">Metropolitana</option>
                        <option value="">Agreste</option>
                        <option value="">Sertão</option>
                        <option value="">São Francisco</option>
                    </select>

                    <span id="span-regiao">Selecione uma opção</span>
                </div>
                

                <!-- Input DESCRIÇÃO -->
                <div class="inputs">
                    <label for="ipt-descricao">Descrição</label>
                    <textarea id="ipt-descricao" rows="10" minlength="20" maxlength="500" placeholder="Descreva em até 500 caracteres..." oninput="descricaoValidate()"></textarea>

                    <span class="alerta" id="min-carac">Mínimo de 20 caracteres</span>
                </div>

                <!-- Input FOTO -->
                <div id="area-maior">
                    <div class="area-menor">
                        <div id="caixa-file">
                            <input type="file" id="file">
                            <label for="file">Procurar Foto</label>
                            
                            <img src="../icons/icone-lupa.svg" alt="Lupa" id="icon-lupa"> 
                        </div>

                        <div id="escolher-img">
                            <img id="imagemPreview" src="" alt="Prévia da imagem">
                        </div>

                        <span class="alerta" id="alerta-img">Foto não selecionada</span>
                    </div>
                </div>
            </form>
        </section>
    </main>

    <footer>
        <a href="../index-deslogado.html">
            <button type="submit" id="btn-enviar" onclick="verificar()">Enviar</button>
        </a>
    </footer>

    <script>
    const inputImg  = document.getElementById('file');
    const previaImg = document.getElementById('imagemPreview');
    // Deixa vázia a caixa da imagem, sem aparecer o ícone de quando uma imagem não é selecionada
    previaImg.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"; 

    inputImg.addEventListener('change', function () {
        const file = inputImg.files[0]; // Obtém o arquivo selecionado

        if (file) {
            const reader = new FileReader();

            // Define uma função para ser executada quando o arquivo for lido
            reader.onload = function (e) {
                previaImg.src = e.target.result; // Define o src da tag <img> com o conteúdo da imagem
            };

            // Lê o arquivo como uma URL de dados
            reader.readAsDataURL(file);
        } else {
            // Define a imagem de espaço reservado vazia se nenhum arquivo for selecionado
            previaImg.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
        }
    });






    // Validação
    const forms       = document.querySelector('form')
    const campos      = document.querySelectorAll('.campos')
    const spans       = document.querySelectorAll('.alerta')
    const emailRegex  = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;


    // Função para mostrar o erro
    function setError(index){
        campos[index].style.border  = "2px solid #000"
        spans [index].style.display = "block" 
    }
    // Função para remover o erro
    function removerError(index){
        campos[index].style.border  = ""
        spans [index].style.display = "none" 
    }

    // Função para validar o nome
    function nameValidate(){
        if(campos[0].value.length < 3){
            setError(0)
        } else{
            removerError(0)
        }
    }

    // Função para validar o endereçco
    function enderecoValidate(){
        if (campos[1].value.length < 20){
            setError(1)
        } else{
            removerError(1)
        }
    }

    // Função para validar o email
    function emailValidate(){
        if(emailRegex.test(campos[2].value)){
            removerError(2)
        } else{
            setError(2)
        }
    }

    // Função para validar o número de contato
    function numeroValidate(){
        if(campos[3].value.length < 14){
            setError(3)
        } else{
            removerError(3)
        }
    }

    // Função para validar o CNPJ
    function cnpjValidate(){
        if(campos[4].value.length < 18){
            setError(4)
        } else{
            removerError(4)
        }
    }

    // Validar o select "Finalidade" (de ONG)
    const spanTipo   = document.getElementById('span-FinalidadeONG')
    const selectTipo = document.getElementById('select-finalidade')
    selectTipo.addEventListener('click', function(){
        // Mostrar o erro
        if (selectTipo.value == 'FinalidadeONG'){
            selectTipo.style.border = "2px solid #000"
            spanTipo.style.display = "block"
        } else{ 
            selectTipo.style.border = "none"
            spanTipo.style.display = "none"
        }
    })

    // Função para validar o pix
    function pixValidate(){
        if(campos[5].value.length < 32){
            setError(5)
        } else{
            removerError(5)
        }
    }

    // Função para validar o número (conta bancária)
    function numcontaValidate(){
        if(campos[6].value.length < 7){
            setError(6)
        } else{
            removerError(6)
        }
    }

    // Função para validar a agência (conta bancária)
    function agenciaValidate(){
        if(campos[7].value.length < 4){
            setError(7)
        } else{
            removerError(7)
        }
    }

    // Função para validar a instituição (conta bancária)
    function instituicaoValidate(){
        if(campos[8].value.length < 4){
            setError(8)
        } else{
            removerError(8)
        }
    }

    // Validar o select "Tipo de conta"
    const spanPagamento   = document.getElementById('span-TipoConta')
    const selectPagamento = document.getElementById('select-conta')    
    selectPagamento.addEventListener('click', function(){
        // Mostrar o erro
        if (selectPagamento.value == 'tipoConta'){
            selectPagamento.style.border = "2px solid #000"
            spanPagamento.style.display = "block"
        } else{ 
            selectPagamento.style.border = "2px solid rgb(0, 166, 255)"
            spanPagamento.style.display = "none"
        }
    })

    
    // Validar select "Região"
    const spanRegiao   = document.getElementById('span-regiao')
    const selectRegiao = document.getElementById('select-regiao')
    selectRegiao.addEventListener('click', function(){
        // Mostrar o erro
        if(selectRegiao.value == 'SelecioneRegiao'){
            selectRegiao.style.border = "2px solid #000"
            spanRegiao.style.display  = "block"
        } else{
            selectRegiao.style.border = "none"
            spanRegiao.style.display  = "none"
        }
    })


    // Função para validar a descrição
    function descricaoValidate(){
        const campoTxtArea = document.getElementById('ipt-descricao')
        const spanMin      = document.querySelector('#min-carac')
        
        // Caso tenha menos de 20 caracteres
        if (campoTxtArea.value.length < 20){
            campoTxtArea.style.border = "2px solid #000"
            spanMin.style.display = "block"
        } else{
            campoTxtArea.style.border = ""
            spanMin.style.display = "none"
        }
    }




    // MÁSCARA

    // Máscara pro contato
    function mascaraTelefone(event) {
        const telefoneInput = event.target;
        let valorTelefone = telefoneInput.value.replace(/\D/g, '');

        if (valorTelefone.length > 11) {
            valorTelefone = valorTelefone.slice(0, 11); // Limita a 11 caracteres
        }

        if (valorTelefone.length <= 10) {
            // Números residenciais:  (XX) XXXX-XXXX
            telefoneInput.value = valorTelefone.replace(/(\d{2})(\d{0,4})(\d{0,4})/, '($1) $2-$3');
        } else {
            // Números pessoais: (XX) XXXXX-XXXX
            telefoneInput.value = valorTelefone.replace(/(\d{2})(\d{0,5})(\d{0,4})/, '($1) $2-$3');
        }
    }
    const inputTelefone = document.getElementById('telefone');
    // Adicione um ouvinte de evento 'input' para chamar a função
    inputTelefone.addEventListener('input', mascaraTelefone);


    // Máscara pro CNPJ
    // Estrutura:  XX. XXX. XXX/XXXX-XX
    const input = document.getElementById('cnpj')
    input.addEventListener('keypress', () => {
        let inputLength = input.value.length

        // IF para add o ponto
        if (inputLength === 2 || inputLength === 6){
            input.value += '.'
        }
        // IF para add a barra
        if (inputLength === 10){
            input.value += '/'
        }
        // IF para add o traço
        if (inputLength === 15){
            input.value += '-'
        }
    })
    </script>
</body>
</html>